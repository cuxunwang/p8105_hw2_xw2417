---
title: "P8105 Homework 2 Solution"
author: "Xun Wang"
date: "9/25/2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
```

This file is the solution to P8105 Homework 2 from Xun Wang (xw2417).

## Problem 1

This problem uses the *Mr. Trash Wheel* dataset. 

#### 1.1 Read and clean the Mr. Trash Wheel sheet.

The code chunk below reads and cleans the *Mr. Trash Wheel* sheet. It omits non-data entrues and rows not including dumpster-specific data, and rounds the number of sports balls to the nearest integer and converts the result to an integer variable.

```{r read_mr_trash_wheel}
mr_trash_wheel_data = 
  readxl::read_excel(
    "data/HealthyHarborWaterWheelTotals2018-7-28.xlsx",
    sheet = "Mr. Trash Wheel",
    range = "A2:N338"
    ) %>%
  janitor::clean_names() %>%
  drop_na(dumpster) %>% 
  mutate(
    date = str_sub(as.character(date), -2, -1),
    sports_balls = as.integer(sports_balls)) %>% 
  select(dumpster, year, month, day = date, everything()) %>% 
  pivot_longer(
    plastic_bottles:sports_balls,
    names_to = "trash_category",
    values_to = "number"
  ) %>% 
  mutate(number = as.numeric(number))
```


#### 1.2 Read and clean precipitation data.

The code chunk below read and clean precipitation data for 2017 and 2018. It omits rows without precipitation data and adds a variable year. Then, it combines precipitation datasets and convert month to a character variable.

```{r read_precipitation}
precip_data_2017 = 
  readxl::read_excel(
    "data/HealthyHarborWaterWheelTotals2018-7-28.xlsx",
    sheet = "2017 Precipitation",
    range = "A2:B14"
    ) %>%
  mutate(year = "2017") %>% 
  janitor::clean_names() 

precip_data_2018 = 
  readxl::read_excel(
    "data/HealthyHarborWaterWheelTotals2018-7-28.xlsx",
    sheet = "2018 Precipitation",
    range = "A2:B14"
    ) %>%
  mutate(year = "2018") %>% 
  janitor::clean_names() %>% 
  drop_na(total)

precip_data = 
  bind_rows(precip_data_2017, precip_data_2018) %>%
  mutate(month = month.name[month]) %>% 
  select(year, month, total_inch = total)
```

#### 1.3 Comments.

**Comments on cleaning data:** Both the *Mr. Trash Wheel* and the *precipitation* datasets are cleaned by `janitor::clean_names`. The *Mr. Trash Wheel* data is also tidied by `pivot_longer` (I combined all the different trash types into one column named *trash_category* and put the values to the column *number*). Since there are column *year* and *month* already, I simplied the *date* column to *day* column only leaving the "day" information in this column.

**Comments on the data:** In the *Mr. Trash Wheel* dataset, there are `r max(pull(mr_trash_wheel_data, dumpster))` observations between 5/16/2014 and 7/18/2018 for 7 categories of trash. The total weight and volume of trash, and the home number the trash powered in each observation are also recorded.For example, on 5/15/2015 in dumpster 60, the total trash weighed 1.95 tons and had a volume of 9 cubic yards, which was used to power 33 homes (key variables). In the *precipitation* dataset, there are `r nrow(precip_data)` observations between `r pull(precip_data, month)[1]` `r pull(precip_data, year)[1]` and `r rev(pull(precip_data, month))[1]` `r rev(pull(precip_data, year))[1]`.For each observation, the total inches of the precipitation was recored. For example, in `r pull(precip_data, month)[1]` `r pull(precip_data, year)[1]`, the precipitation was `r pull(precip_data, total_inch)[1]` inches (key variables). For available data, the **total** precipitation in 2018 was **`r sum(select(filter(precip_data, year == 2018), total_inch))` inches**. The **median** number of sports balls in a dumpster in 2017 was **`r median(pull(filter(mr_trash_wheel_data, year == 2017 & trash_category == 'sports_balls'), number))`**.

## Problem 2

This problem uses the *FiveThirtyEight* dataset. 

#### 2.1 Read and clean the data.

The code chunk below reads and cleans the data in pols-month.csv.

```{r read_pols_month}
party = c("dem", "gop")

pols_month_data = 
  read.csv(file = "./data/fivethirtyeight_datasets/pols-month.csv") %>% 
  janitor::clean_names() %>% 
  separate(mon, into = c("year", "month", "day")) %>% 
  mutate(month = month.name[as.integer(month)],
         president = party[prez_gop + 1]) %>%
  select(year, month, president, everything(), -day, -prez_dem, -prez_gop)
```


## Problem 3